<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.30.9">
    <meta name="project" content="mnesia v4.22.1">


    <title>Getting Started — mnesia v4.22.1</title>
    <link rel="stylesheet" href="dist/html-erlang-QW5RMTQD.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-43PMFBC7.js"></script>
    <script src="dist/sidebar_items-30965689.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-LRUIU55G.js"></script>

<style>.dark img { background-color: white; }</style>
  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="api-reference.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="mnesia" />
        </a>

      <div>
        <a href="api-reference.html" class="sidebar-projectName" translate="no">
mnesia
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v4.22.1
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">
      <div class="top-search">
        <div class="search-settings">
          <form class="search-bar" action="search.html">
            <label class="search-label">
              <span class="sr-only">Search documentation of mnesia</span>
              <input name="q" type="text" class="search-input" placeholder="Search Documentation (press /)" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            </label>
            <button type="submit" class="search-button" aria-label="Submit Search">
              <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
            </button>
            <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
              <i class="ri-close-line ri-lg" title="Cancel search"></i>
            </button>
          </form>
          <button class="icon-settings display-settings">
            <i class="ri-settings-3-line"></i>
            <span class="sr-only">Settings</span>
          </button>
        </div>
      </div>
      <div class="autocomplete">
        <div class="autocomplete-results">
        </div>
      </div>

<h1>

    <a href="https://github.com/erlang/otp/blob/master/lib/mnesia/doc/guides/mnesia_chap2.md#L1" title="View Source" class="icon-action" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>


  <span>Getting Started</span>
</h1>

<p><a href="" id="getting_started"></a> This section introduces <code class="inline">Mnesia</code> with an example
database. This example is referenced in the following sections, where the
example is modified to illustrate various program constructs. This section
illustrates the following mandatory procedures through examples:</p><ul><li>Starting the Erlang session.</li><li>Specifying the <code class="inline">Mnesia</code> directory where the database is to be stored.</li><li>Initializing a new database schema with an attribute that specifies on which
node, or nodes, that database is to operate.</li><li>Starting <code class="inline">Mnesia</code>.</li><li>Creating and populating the database tables.</li></ul><h2 id="starting-mnesia-for-the-first-time" class="section-heading">
  <a href="#starting-mnesia-for-the-first-time" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Starting Mnesia for the First Time</span>
</h2>
<p>This section provides a simplified demonstration of a <code class="inline">Mnesia</code> system startup.
The dialogue from the Erlang shell is as follows:</p><pre><code class="text">        unix&gt;  erl -mnesia dir '&quot;/tmp/funky&quot;'
        Erlang (BEAM) emulator version 4.9

        Eshell V4.9  (abort with ^G)
        1&gt;
        1&gt; mnesia:create_schema([node()]).
        ok
        2&gt; mnesia:start().
        ok
        3&gt; mnesia:create_table(funky, []).
        {atomic,ok}
        4&gt; mnesia:info().
        ---&gt; Processes holding locks &lt;---
        ---&gt; Processes waiting for locks &lt;---
        ---&gt; Pending (remote) transactions &lt;---
        ---&gt; Active (local) transactions &lt;---
        ---&gt; Uncertain transactions &lt;---
        ---&gt; Active tables &lt;---
        funky          : with 0 records occupying 269 words of mem
        schema         : with 2 records occupying 353 words of mem
        ===&gt; System info in version &quot;1.0&quot;, debug level = none &lt;===
        opt_disc. Directory &quot;/tmp/funky&quot; is used.
        use fall-back at restart = false
        running db nodes = [nonode@nohost]
        stopped db nodes = []
        remote           = []
        ram_copies       = [funky]
        disc_copies      = [schema]
        disc_only_copies = []
        [{nonode@nohost,disc_copies}] = [schema]
        [{nonode@nohost,ram_copies}] = [funky]
        1 transactions committed, 0 aborted, 0 restarted, 1 logged to disc
        0 held locks, 0 in queue; 0 local transactions, 0 remote
        0 transactions waits for other nodes: []
        ok</code></pre><p>In this example, the following actions are performed:</p><ul><li><em>Step 1:</em> The Erlang system is started from the UNIX prompt with a flag
<code class="inline">-mnesia dir '&quot;/tmp/funky&quot;'</code>, which indicates in which directory to store the
data.</li><li><em>Step 2:</em> A new empty schema is initialized on the local node by evaluating
[mnesia:create_schema([node()])](<a href="mnesia.html#create_schema/1"><code class="inline">mnesia:create_schema/1</code></a>). The schema
contains information about the database in general. This is explained in
detail later.</li><li><em>Step 3:</em> The DBMS is started by evaluating
<a href="mnesia.html#start/0">mnesia:start()</a>.</li><li><em>Step 4:</em> A first table is created, called <code class="inline">funky</code>, by evaluating the
expression <code class="inline">mnesia:create_table(funky, [])</code>. The table is given default
properties.</li><li><em>Step 5:</em> <a href="mnesia.html#info/0">mnesia:info()</a> is evaluated to display information
on the terminal about the status of the database.</li></ul><h2 id="example" class="section-heading">
  <a href="#example" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Example</span>
</h2>
<p>A <code class="inline">Mnesia</code> database is organized as a set of tables. Each table is populated
with instances (Erlang records). A table has also a number of properties, such
as location and persistence.</p><h3 id="database" class="section-heading">
  <a href="#database" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Database</span>
</h3>
<p>This example shows how to create a database called <code class="inline">Company</code> and the
relationships shown in the following diagram:</p><p><img src="assets/company.gif" alt="Company Entity-Relation Diagram" title="Company Entity-Relation Diagram"/></p><p>The database model is as follows:</p><ul><li>There are three entities: department, employee, and project.</li><li>There are three relationships between these entities:<ol><li>A department is managed by an employee, hence the <code class="inline">manager</code> relationship.</li><li>An employee works at a department, hence the <code class="inline">at_dep</code> relationship.</li><li>Each employee works on a number of projects, hence the <code class="inline">in_proj</code>
relationship.</li></ol></li></ul><h3 id="defining-structure-and-content" class="section-heading">
  <a href="#defining-structure-and-content" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Defining Structure and Content</span>
</h3>
<p>First the record definitions are entered into a text file named <code class="inline">company.hrl</code>.
This file defines the following structure for the example database:</p><pre><code class="makeup erlang" translate="no"><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-1">(</span><span class="ss">employee</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-2">{</span><span class="ss">emp_no</span><span class="p">,</span><span class="w">
                   </span><span class="ss">name</span><span class="p">,</span><span class="w">
                   </span><span class="ss">salary</span><span class="p">,</span><span class="w">
                   </span><span class="ss">sex</span><span class="p">,</span><span class="w">
                   </span><span class="ss">phone</span><span class="p">,</span><span class="w">
                   </span><span class="ss">room_no</span><span class="p" data-group-id="2420684449-2">}</span><span class="p" data-group-id="2420684449-1">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-3">(</span><span class="ss">dept</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-4">{</span><span class="ss">id</span><span class="p">,</span><span class="w">
               </span><span class="ss">name</span><span class="p" data-group-id="2420684449-4">}</span><span class="p" data-group-id="2420684449-3">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-5">(</span><span class="ss">project</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-6">{</span><span class="ss">name</span><span class="p">,</span><span class="w">
                  </span><span class="ss">number</span><span class="p" data-group-id="2420684449-6">}</span><span class="p" data-group-id="2420684449-5">)</span><span class="p">.</span><span class="w">
</span><span class="w">

</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-7">(</span><span class="ss">manager</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-8">{</span><span class="ss">emp</span><span class="p">,</span><span class="w">
                  </span><span class="ss">dept</span><span class="p" data-group-id="2420684449-8">}</span><span class="p" data-group-id="2420684449-7">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-9">(</span><span class="ss">at_dep</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-10">{</span><span class="ss">emp</span><span class="p">,</span><span class="w">
                 </span><span class="ss">dept_id</span><span class="p" data-group-id="2420684449-10">}</span><span class="p" data-group-id="2420684449-9">)</span><span class="p">.</span><span class="w">
</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="2420684449-11">(</span><span class="ss">in_proj</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2420684449-12">{</span><span class="ss">emp</span><span class="p">,</span><span class="w">
                  </span><span class="ss">proj_name</span><span class="p" data-group-id="2420684449-12">}</span><span class="p" data-group-id="2420684449-11">)</span><span class="p">.</span></code></pre><p>The structure defines six tables in the database. In <code class="inline">Mnesia</code>, the function
<a href="mnesia.html#create_table/2">mnesia:create_table(Name, ArgList)</a> creates tables.
<code class="inline">Name</code> is the table name.</p><blockquote><h4 class="info">Note</h4><p>The current version of <code class="inline">Mnesia</code> does not require that the name of the table is
the same as the record name, see
<a href="mnesia_chap4.html#recordnames_tablenames">Record Names versus Table Names.</a>.</p></blockquote><p>For example, the table for employees is created with the function
<code class="inline">mnesia:create_table(employee, [{attributes, record_info(fields, employee)}])</code>.
The table name <code class="inline">employee</code> matches the name for records specified in <code class="inline">ArgList</code>.
The expression <code class="inline">record_info(fields, RecordName)</code> is processed by the Erlang
preprocessor and evaluates to a list containing the names of the different
fields for a record.</p><h3 id="program" class="section-heading">
  <a href="#program" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Program</span>
</h3>
<p>The following shell interaction starts <code class="inline">Mnesia</code> and initializes the schema for
the <code class="inline">Company</code> database:</p><pre><code class="text">        % erl -mnesia dir '&quot;/ldisc/scratch/Mnesia.Company&quot;'
         Erlang (BEAM) emulator version 4.9

          Eshell V4.9  (abort with ^G)
          1&gt; mnesia:create_schema([node()]).
          ok
          2&gt; mnesia:start().
          ok</code></pre><p>The following program module creates and populates previously defined tables:</p><pre><code class="makeup erlang" translate="no"><span class="w">

</span><span class="p">-</span><span class="na">include_lib</span><span class="p" data-group-id="1514409037-1">(</span><span class="s">&quot;stdlib/include/qlc.hrl&quot;</span><span class="p" data-group-id="1514409037-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">include</span><span class="p" data-group-id="1514409037-2">(</span><span class="s">&quot;company.hrl&quot;</span><span class="p" data-group-id="1514409037-2">)</span><span class="p">.</span><span class="w">

</span><span class="nf">init</span><span class="p" data-group-id="1514409037-3">(</span><span class="p" data-group-id="1514409037-3">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-4">(</span><span class="ss">employee</span><span class="p">,</span><span class="w">
                        </span><span class="p" data-group-id="1514409037-5">[</span><span class="p" data-group-id="1514409037-6">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-7">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">employee</span><span class="p" data-group-id="1514409037-7">)</span><span class="p" data-group-id="1514409037-6">}</span><span class="p" data-group-id="1514409037-5">]</span><span class="p" data-group-id="1514409037-4">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-8">(</span><span class="ss">dept</span><span class="p">,</span><span class="w">
                        </span><span class="p" data-group-id="1514409037-9">[</span><span class="p" data-group-id="1514409037-10">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-11">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">dept</span><span class="p" data-group-id="1514409037-11">)</span><span class="p" data-group-id="1514409037-10">}</span><span class="p" data-group-id="1514409037-9">]</span><span class="p" data-group-id="1514409037-8">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-12">(</span><span class="ss">project</span><span class="p">,</span><span class="w">
                        </span><span class="p" data-group-id="1514409037-13">[</span><span class="p" data-group-id="1514409037-14">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-15">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">project</span><span class="p" data-group-id="1514409037-15">)</span><span class="p" data-group-id="1514409037-14">}</span><span class="p" data-group-id="1514409037-13">]</span><span class="p" data-group-id="1514409037-12">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-16">(</span><span class="ss">manager</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1514409037-17">[</span><span class="p" data-group-id="1514409037-18">{</span><span class="ss">type</span><span class="p">,</span><span class="w"> </span><span class="ss">bag</span><span class="p" data-group-id="1514409037-18">}</span><span class="p">,</span><span class="w">
                                  </span><span class="p" data-group-id="1514409037-19">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-20">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">manager</span><span class="p" data-group-id="1514409037-20">)</span><span class="p" data-group-id="1514409037-19">}</span><span class="p" data-group-id="1514409037-17">]</span><span class="p" data-group-id="1514409037-16">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-21">(</span><span class="ss">at_dep</span><span class="p">,</span><span class="w">
                         </span><span class="p" data-group-id="1514409037-22">[</span><span class="p" data-group-id="1514409037-23">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-24">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">at_dep</span><span class="p" data-group-id="1514409037-24">)</span><span class="p" data-group-id="1514409037-23">}</span><span class="p" data-group-id="1514409037-22">]</span><span class="p" data-group-id="1514409037-21">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p" data-group-id="1514409037-25">(</span><span class="ss">in_proj</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1514409037-26">[</span><span class="p" data-group-id="1514409037-27">{</span><span class="ss">type</span><span class="p">,</span><span class="w"> </span><span class="ss">bag</span><span class="p" data-group-id="1514409037-27">}</span><span class="p">,</span><span class="w">
                                  </span><span class="p" data-group-id="1514409037-28">{</span><span class="ss">attributes</span><span class="p">,</span><span class="w"> </span><span class="nf">record_info</span><span class="p" data-group-id="1514409037-29">(</span><span class="ss">fields</span><span class="p">,</span><span class="w"> </span><span class="ss">in_proj</span><span class="p" data-group-id="1514409037-29">)</span><span class="p" data-group-id="1514409037-28">}</span><span class="p" data-group-id="1514409037-26">]</span><span class="p" data-group-id="1514409037-25">)</span><span class="p">.</span></code></pre><h3 id="program-explained" class="section-heading">
  <a href="#program-explained" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Program Explained</span>
</h3>
<p>The following commands and functions are used to initiate the <code class="inline">Company</code>
database:</p><ul><li><code class="inline">% erl -mnesia dir '&quot;/ldisc/scratch/Mnesia.Company&quot;'</code>. This is a UNIX
command-line entry that starts the Erlang system. The flag <code class="inline">-mnesia dir Dir</code>
specifies the location of the database directory. The system responds and
waits for further input with the prompt <code class="inline">1&gt;</code>.</li><li>[mnesia:create_schema([node()])](<a href="mnesia.html#create_schema/1"><code class="inline">mnesia:create_schema/1</code></a>). This function has
the format <code class="inline">mnesia:create_schema(DiscNodeList)</code> and initiates a new schema. In
this example, a non-distributed system using only one node is created. Schemas
are fully explained in <a href="mnesia_chap3.html#def_schema">Define a Schema</a>.</li><li><a href="mnesia.html#start/0">mnesia:start()</a>. This function starts <code class="inline">Mnesia</code> and is fully
explained in <a href="mnesia_chap3.html#start_mnesia">Start Mnesia</a>.</li></ul><p>Continuing the dialogue with the Erlang shell produces the following:</p><pre><code class="text">        3&gt; company:init().
        {atomic,ok}
        4&gt; mnesia:info().
        ---&gt; Processes holding locks &lt;---
        ---&gt; Processes waiting for locks &lt;---
        ---&gt; Pending (remote) transactions &lt;---
        ---&gt; Active (local) transactions &lt;---
        ---&gt; Uncertain transactions &lt;---
        ---&gt; Active tables &lt;---
        in_proj        : with 0 records occuping 269 words of mem
        at_dep         : with 0 records occuping 269 words of mem
        manager        : with 0 records occuping 269 words of mem
        project        : with 0 records occuping 269 words of mem
        dept           : with 0 records occuping 269 words of mem
        employee       : with 0 records occuping 269 words of mem
        schema         : with 7 records occuping 571 words of mem
        ===&gt; System info in version &quot;1.0&quot;, debug level = none &lt;===
        opt_disc. Directory &quot;/ldisc/scratch/Mnesia.Company&quot; is used.
        use fall-back at restart = false
        running db nodes = [nonode@nohost]
        stopped db nodes = []
        remote           = []
        ram_copies       =
            [at_dep,dept,employee,in_proj,manager,project]
        disc_copies      = [schema]
        disc_only_copies = []
        [{nonode@nohost,disc_copies}] = [schema]
        [{nonode@nohost,ram_copies}] =
            [employee,dept,project,manager,at_dep,in_proj]
        6 transactions committed, 0 aborted, 0 restarted, 6 logged to disc
        0 held locks, 0 in queue; 0 local transactions, 0 remote
        0 transactions waits for other nodes: []
        ok</code></pre><p>A set of tables is created. The function
<a href="mnesia.html#create_table/2">mnesia:create_table(Name, ArgList)</a> creates the
required database tables. The options available with <code class="inline">ArgList</code> are explained in
<a href="mnesia_chap3.html#create_tables">Create New Tables</a>.</p><p>The function <code class="inline">company:init/0</code> creates the tables. Two tables are of type <code class="inline">bag</code>.
This is the <code class="inline">manager</code> relation as well the <code class="inline">in_proj</code> relation. This is
interpreted as: an employee can be manager over several departments, and an
employee can participate in several projects. However, the <code class="inline">at_dep</code> relation is
<code class="inline">set</code>, as an employee can only work in one department. In this data model, there
are examples of relations that are 1-to-1 (<code class="inline">set</code>) and 1-to-many (<code class="inline">bag</code>).</p><p><a href="mnesia.html#info/0">mnesia:info()</a> now indicates that a database has seven local
tables, where six are the user-defined tables and one is the schema. Six
transactions have been committed, as six successful transactions were run when
creating the tables.</p><p>To write a function that inserts an employee record into the database, there
must be an <code class="inline">at_dep</code> record and a set of <code class="inline">in_proj</code> records inserted. Examine the
following code used to complete this action:</p><pre><code class="makeup erlang" translate="no"><span class="w">

</span><span class="nf">insert_emp</span><span class="p" data-group-id="1216301280-1">(</span><span class="n">Emp</span><span class="p">,</span><span class="w"> </span><span class="n">DeptId</span><span class="p">,</span><span class="w"> </span><span class="n">ProjNames</span><span class="p" data-group-id="1216301280-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Ename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Emp</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">name</span><span class="p">,</span><span class="w">
    </span><span class="n">Fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="1216301280-2">(</span><span class="p" data-group-id="1216301280-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                  </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="1216301280-3">(</span><span class="n">Emp</span><span class="p" data-group-id="1216301280-3">)</span><span class="p">,</span><span class="w">
                  </span><span class="n">AtDep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">#</span><span class="ss">at_dep</span><span class="p" data-group-id="1216301280-4">{</span><span class="ss">emp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ename</span><span class="p">,</span><span class="w"> </span><span class="ss">dept_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DeptId</span><span class="p" data-group-id="1216301280-4">}</span><span class="p">,</span><span class="w">
                  </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="1216301280-5">(</span><span class="n">AtDep</span><span class="p" data-group-id="1216301280-5">)</span><span class="p">,</span><span class="w">
                  </span><span class="nf">mk_projs</span><span class="p" data-group-id="1216301280-6">(</span><span class="n">Ename</span><span class="p">,</span><span class="w"> </span><span class="n">ProjNames</span><span class="p" data-group-id="1216301280-6">)</span><span class="w">
          </span><span class="k">end</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">transaction</span><span class="p" data-group-id="1216301280-7">(</span><span class="n">Fun</span><span class="p" data-group-id="1216301280-7">)</span><span class="p">.</span><span class="w">


</span><span class="nf">mk_projs</span><span class="p" data-group-id="1216301280-8">(</span><span class="n">Ename</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1216301280-9">[</span><span class="n">ProjName</span><span class="p">|</span><span class="n">Tail</span><span class="p" data-group-id="1216301280-9">]</span><span class="p" data-group-id="1216301280-8">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="1216301280-10">(</span><span class="o">#</span><span class="ss">in_proj</span><span class="p" data-group-id="1216301280-11">{</span><span class="ss">emp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ename</span><span class="p">,</span><span class="w"> </span><span class="ss">proj_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ProjName</span><span class="p" data-group-id="1216301280-11">}</span><span class="p" data-group-id="1216301280-10">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">mk_projs</span><span class="p" data-group-id="1216301280-12">(</span><span class="n">Ename</span><span class="p">,</span><span class="w"> </span><span class="n">Tail</span><span class="p" data-group-id="1216301280-12">)</span><span class="p">;</span><span class="w">
</span><span class="nf">mk_projs</span><span class="p" data-group-id="1216301280-13">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1216301280-14">[</span><span class="p" data-group-id="1216301280-14">]</span><span class="p" data-group-id="1216301280-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="p">.</span></code></pre><ul><li>The <code class="inline">insert_emp/3</code> arguments are as follows:<ol><li><code class="inline">Emp</code> is an employee record.</li><li><code class="inline">DeptId</code> is the identity of the department where the employee works.</li><li><code class="inline">ProjNames</code> is a list of the names of the projects where the employee
works.</li></ol></li></ul><p>The function <code class="inline">insert_emp/3</code> creates a Functional Object (Fun). <code class="inline">Fun</code> is passed
as a single argument to the function
<a href="mnesia.html#transaction/1">mnesia:transaction(Fun)</a>. This means that <code class="inline">Fun</code> is run
as a transaction with the following properties:</p><ul><li>A <code class="inline">Fun</code> either succeeds or fails.</li><li>Code that manipulates the same data records can be run concurrently without
the different processes interfering with each other.</li></ul><p>The function can be used as follows:</p><pre><code class="text">          Emp  = #employee{emp_no= 104732,
                           name = klacke,
                           salary = 7,
                           sex = male,
                           phone = 98108,
                           room_no = {221, 015}},
        insert_emp(Emp, 'B/SFR', [Erlang, mnesia, otp]).</code></pre><blockquote><h4 class="info">Note</h4><p>For information about Funs, see &quot;Fun Expressions&quot; in section
<code class="inline">Erlang Reference Manual</code> in System Documentation..</p></blockquote><h3 id="initial-database-content" class="section-heading">
  <a href="#initial-database-content" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Initial Database Content</span>
</h3>
<p>After the insertion of the employee named <code class="inline">klacke</code>, the database has the
following records:</p><table id="table2_1"><thead><tr><th style="text-align: left;">emp_no</th><th style="text-align: left;">name</th><th style="text-align: left;">salary</th><th style="text-align: left;">sex</th><th style="text-align: left;">phone</th><th style="text-align: left;">room_no</th></tr></thead><tbody><tr><td style="text-align: left;">104732</td><td style="text-align: left;">klacke</td><td style="text-align: left;">7</td><td style="text-align: left;">male</td><td style="text-align: left;">98108</td><td style="text-align: left;">{221, 015}</td></tr></tbody></table><p><em>Table: employee Database Record</em></p><p>This <code class="inline">employee</code> record has the Erlang record/tuple representation
<code class="inline">{employee, 104732, klacke, 7, male, 98108, {221, 015}}</code>.</p><table id="table2_2"><thead><tr><th style="text-align: left;">emp</th><th style="text-align: left;">dept_name</th></tr></thead><tbody><tr><td style="text-align: left;">klacke</td><td style="text-align: left;">B/SFR</td></tr></tbody></table><p><em>Table: at_dep Database Record</em></p><p>This <code class="inline">at_dep</code> record has the Erlang tuple representation
<code class="inline">{at_dep, klacke, 'B/SFR'}</code>.</p><table id="table3_3"><thead><tr><th style="text-align: left;">emp</th><th style="text-align: left;">proj_name</th></tr></thead><tbody><tr><td style="text-align: left;">klacke</td><td style="text-align: left;">Erlang</td></tr><tr><td style="text-align: left;">klacke</td><td style="text-align: left;">otp</td></tr><tr><td style="text-align: left;">klacke</td><td style="text-align: left;">mnesia</td></tr></tbody></table><p><em>Table: in_proj Database Record</em></p><p>This <code class="inline">in_proj</code> record has the Erlang tuple representation
<code class="inline">{in_proj, klacke, 'Erlang', klacke, 'otp', klacke, 'mnesia'}</code>.</p><p>There is no difference between rows in a table and <code class="inline">Mnesia</code> records. Both
concepts are the same and are used interchangeably throughout this User's Guide.</p><p>A <code class="inline">Mnesia</code> table is populated by <code class="inline">Mnesia</code> records. For example, the tuple
<code class="inline">{boss, klacke, bjarne}</code> is a record. The second element in this tuple is the
key. To identify a table uniquely, both the key and the table name is needed.
The term Object Identifier (OID) is sometimes used for the arity two tuple
{Tab, Key}. The OID for the record <code class="inline">{boss, klacke, bjarne}</code> is the arity two
tuple <code class="inline">{boss, klacke}</code>. The first element of the tuple is the type of the record
and the second element is the key. An OID can lead to zero, one, or more records
depending on whether the table type is <code class="inline">set</code> or <code class="inline">bag</code>.</p><p>The record <code class="inline">{boss, klacke, bjarne}</code> can also be inserted. This record contains
an implicit reference to another employee that does not yet exist in the
database. <code class="inline">Mnesia</code> does not enforce this.</p><h3 id="adding-records-and-relationships-to-database" class="section-heading">
  <a href="#adding-records-and-relationships-to-database" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Adding Records and Relationships to Database</span>
</h3>
<p>After adding more records to the <code class="inline">Company</code> database, the result can be the
following records:</p><p><code class="inline">employees</code>:</p><pre><code class="text">        {employee, 104465, &quot;Johnson Torbjorn&quot;,   1, male,  99184, {242,038}}.
        {employee, 107912, &quot;Carlsson Tuula&quot;,     2, female,94556, {242,056}}.
        {employee, 114872, &quot;Dacker Bjarne&quot;,      3, male,  99415, {221,035}}.
        {employee, 104531, &quot;Nilsson Hans&quot;,       3, male,  99495, {222,026}}.
        {employee, 104659, &quot;Tornkvist Torbjorn&quot;, 2, male,  99514, {222,022}}.
        {employee, 104732, &quot;Wikstrom Claes&quot;,     2, male,  99586, {221,015}}.
        {employee, 117716, &quot;Fedoriw Anna&quot;,       1, female,99143, {221,031}}.
        {employee, 115018, &quot;Mattsson Hakan&quot;,     3, male,  99251, {203,348}}.</code></pre><p><code class="inline">dept</code>:</p><pre><code class="text">        {dept, 'B/SF',  &quot;Open Telecom Platform&quot;}.
        {dept, 'B/SFP', &quot;OTP - Product Development&quot;}.
        {dept, 'B/SFR', &quot;Computer Science Laboratory&quot;}.</code></pre><p><code class="inline">projects</code>:</p><pre><code class="text">        %% projects
        {project, erlang, 1}.
        {project, otp, 2}.
        {project, beam, 3}.
        {project, mnesia, 5}.
        {project, wolf, 6}.
        {project, documentation, 7}.
        {project, www, 8}.</code></pre><p>These three tables, <code class="inline">employees</code>, <code class="inline">dept</code>, and <code class="inline">projects</code>, are made up of real
records. The following database content is stored in the tables and is built on
relationships. These tables are <code class="inline">manager</code>, <code class="inline">at_dep</code>, and <code class="inline">in_proj</code>.</p><p><code class="inline">manager</code>:</p><pre><code class="text">        {manager, 104465, 'B/SF'}.
        {manager, 104465, 'B/SFP'}.
        {manager, 114872, 'B/SFR'}.</code></pre><p><code class="inline">at_dep</code>:</p><pre><code class="text">        {at_dep, 104465, 'B/SF'}.
        {at_dep, 107912, 'B/SF'}.
        {at_dep, 114872, 'B/SFR'}.
        {at_dep, 104531, 'B/SFR'}.
        {at_dep, 104659, 'B/SFR'}.
        {at_dep, 104732, 'B/SFR'}.
        {at_dep, 117716, 'B/SFP'}.
        {at_dep, 115018, 'B/SFP'}.</code></pre><p><code class="inline">in_proj</code>:</p><pre><code class="text">        {in_proj, 104465, otp}.
        {in_proj, 107912, otp}.
        {in_proj, 114872, otp}.
        {in_proj, 104531, otp}.
        {in_proj, 104531, mnesia}.
        {in_proj, 104545, wolf}.
        {in_proj, 104659, otp}.
        {in_proj, 104659, wolf}.
        {in_proj, 104732, otp}.
        {in_proj, 104732, mnesia}.
        {in_proj, 104732, erlang}.
        {in_proj, 117716, otp}.
        {in_proj, 117716, documentation}.
        {in_proj, 115018, otp}.
        {in_proj, 115018, mnesia}.</code></pre><p>The room number is an attribute of the employee record. This is a structured
attribute that consists of a tuple. The first element of the tuple identifies a
corridor, and the second element identifies the room in that corridor. An
alternative is to represent this as a record <code class="inline">-record(room, {corr, no}).</code>
instead of an anonymous tuple representation.</p><p>The <code class="inline">Company</code> database is now initialized and contains data.</p><h3 id="writing-queries" class="section-heading">
  <a href="#writing-queries" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Writing Queries</span>
</h3>
<p>Retrieving data from DBMS is usually to be done with the functions
<a href="mnesia.html#read/3"><code class="inline">mnesia:read/3</code></a> or <a href="mnesia.html#read/2">mnesia:read/1</a>. The following function
raises the salary:</p><pre><code class="makeup erlang" translate="no"><span class="w">
</span><span class="nf">raise</span><span class="p" data-group-id="3596430781-1">(</span><span class="n">Eno</span><span class="p">,</span><span class="w"> </span><span class="n">Raise</span><span class="p" data-group-id="3596430781-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="3596430781-2">(</span><span class="p" data-group-id="3596430781-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                </span><span class="p" data-group-id="3596430781-3">[</span><span class="n">E</span><span class="p" data-group-id="3596430781-3">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">read</span><span class="p" data-group-id="3596430781-4">(</span><span class="ss">employee</span><span class="p">,</span><span class="w"> </span><span class="n">Eno</span><span class="p">,</span><span class="w"> </span><span class="ss">write</span><span class="p" data-group-id="3596430781-4">)</span><span class="p">,</span><span class="w">
                </span><span class="n">Salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">salary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Raise</span><span class="p">,</span><span class="w">
                </span><span class="n">New</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p" data-group-id="3596430781-5">{</span><span class="ss">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Salary</span><span class="p" data-group-id="3596430781-5">}</span><span class="p">,</span><span class="w">
                </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="3596430781-6">(</span><span class="n">New</span><span class="p" data-group-id="3596430781-6">)</span><span class="w">
        </span><span class="k">end</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">transaction</span><span class="p" data-group-id="3596430781-7">(</span><span class="n">F</span><span class="p" data-group-id="3596430781-7">)</span><span class="p">.</span></code></pre><p>Since it is desired to update the record using the function <a href="mnesia.html#write/1"><code class="inline">mnesia:write/1</code></a>
after the salary has been increased, a write lock (third argument to <code class="inline">read</code>) is
acquired when the record from the table is read.</p><p>To read the values from the table directly is not always possible. It can be
needed to search one or more tables to get the wanted data, and this is done by
writing database queries. Queries are always more expensive operations than
direct lookups done with <code class="inline">mnesia:read</code>. Therefore, avoid queries in
performance-critical code.</p><p>Two methods are available for writing database queries:</p><ul><li><code class="inline">Mnesia</code> functions</li><li>QLC</li></ul><h4>Using Mnesia Functions</h4><p>The following function extracts the names of the female employees stored in the
database:</p><pre><code class="text">mnesia:select(employee, [{#employee{sex = female, name = '$1', _ = '_'},[], ['$1']}]).</code></pre><p><code class="inline">select</code> must always run within an activity, such as a transaction. The
following function can be constructed to call from the shell:</p><pre><code class="makeup erlang" translate="no"><span class="w">
</span><span class="nf">all_females</span><span class="p" data-group-id="5665404966-1">(</span><span class="p" data-group-id="5665404966-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="5665404966-2">(</span><span class="p" data-group-id="5665404966-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="n">Female</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">#</span><span class="ss">employee</span><span class="p" data-group-id="5665404966-3">{</span><span class="ss">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">female</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&#39;$1&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&#39;_&#39;</span><span class="p" data-group-id="5665404966-3">}</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">select</span><span class="p" data-group-id="5665404966-4">(</span><span class="ss">employee</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5665404966-5">[</span><span class="p" data-group-id="5665404966-6">{</span><span class="n">Female</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5665404966-7">[</span><span class="p" data-group-id="5665404966-7">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5665404966-8">[</span><span class="ss">&#39;$1&#39;</span><span class="p" data-group-id="5665404966-8">]</span><span class="p" data-group-id="5665404966-6">}</span><span class="p" data-group-id="5665404966-5">]</span><span class="p" data-group-id="5665404966-4">)</span><span class="w">
        </span><span class="k">end</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">transaction</span><span class="p" data-group-id="5665404966-9">(</span><span class="n">F</span><span class="p" data-group-id="5665404966-9">)</span><span class="p">.</span></code></pre><p>The <code class="inline">select</code> expression matches all entries in table employee with the field
<code class="inline">sex</code> set to <code class="inline">female</code>.</p><p>This function can be called from the shell as follows:</p><pre><code class="text">          (klacke@gin)1&gt; company:all_females().
          {atomic,  [&quot;Carlsson Tuula&quot;, &quot;Fedoriw Anna&quot;]}</code></pre><p>For a description of <code class="inline">select</code> and its syntax, see
<a href="mnesia_chap4.html#matching">Pattern Matching</a>.</p><h4>Using QLC</h4><p>This section contains simple introductory examples only. For a full description
of the QLC query language, see the <a href="../../../../lib/stdlib/doc/html/qlc.html"><code class="inline">qlc</code></a> manual page in <code class="inline">STDLIB</code>.</p><p>Using QLC can be more expensive than using <code class="inline">Mnesia</code> functions directly but
offers a nice syntax.</p><p>The following function extracts a list of female employees from the database:</p><pre><code class="text">          Q = qlc:q([E#employee.name || E &lt;- mnesia:table(employee),
                                E#employee.sex == female]),
          qlc:e(Q),</code></pre><p>Accessing <code class="inline">Mnesia</code> tables from a QLC list comprehension must always be done
within a transaction. Consider the following function:</p><pre><code class="makeup erlang" translate="no"><span class="w">
</span><span class="nf">females</span><span class="p" data-group-id="9654090512-1">(</span><span class="p" data-group-id="9654090512-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="9654090512-2">(</span><span class="p" data-group-id="9654090512-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="9654090512-3">(</span><span class="p" data-group-id="9654090512-4">[</span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">name</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="9654090512-5">(</span><span class="ss">employee</span><span class="p" data-group-id="9654090512-5">)</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="err">	</span><span class="err">	</span><span class="err">	</span><span class="w">      </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">female</span><span class="p" data-group-id="9654090512-4">]</span><span class="p" data-group-id="9654090512-3">)</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">e</span><span class="p" data-group-id="9654090512-6">(</span><span class="n">Q</span><span class="p" data-group-id="9654090512-6">)</span><span class="w">
</span><span class="err">	</span><span class="k">end</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">transaction</span><span class="p" data-group-id="9654090512-7">(</span><span class="n">F</span><span class="p" data-group-id="9654090512-7">)</span><span class="p">.</span></code></pre><p>This function can be called from the shell as follows:</p><pre><code class="text">          (klacke@gin)1&gt; company:females().
          {atomic, [&quot;Carlsson Tuula&quot;, &quot;Fedoriw Anna&quot;]}</code></pre><p>In traditional relational database terminology, this operation is called a
selection, followed by a projection.</p><p>The previous list comprehension expression contains a number of syntactical
elements:</p><ul><li>The first <code class="inline">[</code> bracket is read as &quot;build the list&quot;.</li><li>The <code class="inline">||</code> &quot;such that&quot; and the arrow <code class="inline">&lt;-</code> is read as &quot;taken from&quot;.</li></ul><p>Hence, the previous list comprehension demonstrates the formation of the list
<code class="inline">E#employee.name</code> such that <code class="inline">E</code> is taken from the table of employees, and
attribute <code class="inline">sex</code> of each record is equal to the atom <code class="inline">female</code>.</p><p>The whole list comprehension must be given to the function <a href="../../../../lib/stdlib/doc/html/qlc.html#q/1"><code class="inline">qlc:q/1</code></a>.</p><p>List comprehensions with low-level <code class="inline">Mnesia</code> functions can be combined in the
same transaction. To raise the salary of all female employees, execute the
following:</p><pre><code class="makeup erlang" translate="no"><span class="w">
</span><span class="nf">raise_females</span><span class="p" data-group-id="9100297375-1">(</span><span class="n">Amount</span><span class="p" data-group-id="9100297375-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="9100297375-2">(</span><span class="p" data-group-id="9100297375-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="9100297375-3">(</span><span class="p" data-group-id="9100297375-4">[</span><span class="n">E</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">E</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="9100297375-5">(</span><span class="ss">employee</span><span class="p" data-group-id="9100297375-5">)</span><span class="p">,</span><span class="w">
                                </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">sex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">female</span><span class="p" data-group-id="9100297375-4">]</span><span class="p" data-group-id="9100297375-3">)</span><span class="p">,</span><span class="w">
</span><span class="err">	</span><span class="err">	</span><span class="n">Fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">e</span><span class="p" data-group-id="9100297375-6">(</span><span class="n">Q</span><span class="p" data-group-id="9100297375-6">)</span><span class="p">,</span><span class="w">
                </span><span class="nf">over_write</span><span class="p" data-group-id="9100297375-7">(</span><span class="n">Fs</span><span class="p">,</span><span class="w"> </span><span class="n">Amount</span><span class="p" data-group-id="9100297375-7">)</span><span class="w">
        </span><span class="k">end</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">transaction</span><span class="p" data-group-id="9100297375-8">(</span><span class="n">F</span><span class="p" data-group-id="9100297375-8">)</span><span class="p">.</span><span class="w">

</span><span class="nf">over_write</span><span class="p" data-group-id="9100297375-9">(</span><span class="p" data-group-id="9100297375-10">[</span><span class="n">E</span><span class="p">|</span><span class="n">Tail</span><span class="p" data-group-id="9100297375-10">]</span><span class="p">,</span><span class="w"> </span><span class="n">Amount</span><span class="p" data-group-id="9100297375-9">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p">.</span><span class="ss">salary</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Amount</span><span class="p">,</span><span class="w">
    </span><span class="n">New</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">E</span><span class="o">#</span><span class="ss">employee</span><span class="p" data-group-id="9100297375-11">{</span><span class="ss">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Salary</span><span class="p" data-group-id="9100297375-11">}</span><span class="p">,</span><span class="w">
    </span><span class="nc">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p" data-group-id="9100297375-12">(</span><span class="n">New</span><span class="p" data-group-id="9100297375-12">)</span><span class="p">,</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">over_write</span><span class="p" data-group-id="9100297375-13">(</span><span class="n">Tail</span><span class="p">,</span><span class="w"> </span><span class="n">Amount</span><span class="p" data-group-id="9100297375-13">)</span><span class="p">;</span><span class="w">
</span><span class="nf">over_write</span><span class="p" data-group-id="9100297375-14">(</span><span class="p" data-group-id="9100297375-15">[</span><span class="p" data-group-id="9100297375-15">]</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9100297375-14">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="mi">0</span><span class="p">.</span></code></pre><p>The function <code class="inline">raise_females/1</code> returns the tuple <code class="inline">{atomic, Number}</code>, where
<code class="inline">Number</code> is the number of female employees who received a salary increase. If an
error occurs, the value <code class="inline">{aborted, Reason}</code> is returned, and <code class="inline">Mnesia</code> guarantees
that the salary is not raised for any employee.</p><p><em>Example:</em></p><pre><code class="text">          33&gt;company:raise_females(33).
          {atomic,2}</code></pre>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="mnesia_overview.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Overview
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="mnesia_chap3.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Build a Mnesia Database
        </span>
      </a>

  </div>
</div>
      <footer class="footer">
        <p>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.30.9) for the

            <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

        </p>
      </footer>
    </div>
  </div>
</main>
</div>


  </body>
</html>

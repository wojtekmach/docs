<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.28.4">
    <meta name="project" content="req v0.3.0-dev">

    <title>Req.Request â€” req v0.3.0-dev</title>
    <link rel="stylesheet" href="dist/elixir-b6f1ed5df9b1d42a7309.css" />

    <script src="dist/sidebar_items-7c4eb7eafe.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/app-bd1cb213813bf4825aa2.js"></script>


  </head>
  <body data-type="modules">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">


<section class="sidebar">
  <button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
    <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
  </button>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

    <div class="sidebar-projectDetails">
      <a href="readme.html" class="sidebar-projectName" translate="no">
req
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.3.0-dev
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">Req.Request</span> 
  <small class="app-vsn" translate="no">(req v0.3.0-dev)</small>

</h1>


  <section id="moduledoc">
<p>The low-level API and the request struct.</p><p>Req is composed of three main pieces:</p><ul><li><p><a href="Req.html"><code class="inline">Req</code></a> - the high-level API</p></li><li><p><a href="Req.Request.html#content"><code class="inline">Req.Request</code></a> - the low-level API and the request struct (you're here!)</p></li><li><p><a href="Req.Steps.html"><code class="inline">Req.Steps</code></a> - the collection of built-in steps</p></li></ul><p>The low-level API and the request struct is the foundation of Req's extensibility. Virtually all
of the functionality is broken down into individual pieces - steps. Req works by running the
request struct through these steps. You can easily reuse or rearrange built-in steps or write new
ones.</p><p>To make using custom steps by others even easier, they can be packaged up into plugins.
See <a href="#module-writing-plugins">&quot;Wriging Plugins&quot;</a> section for more information.</p><h2 id="module-the-low-level-api" class="section-heading">
  <a href="#module-the-low-level-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">the-low-level-api</p>
  </a>
  The Low-level API
</h2>
<p>Most Req users would use it like this:</p><pre><code class="makeup elixir" translate="no"><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="2032259416-1">(</span><span class="s">&quot;https://api.github.com/repos/elixir-lang/elixir&quot;</span><span class="p" data-group-id="2032259416-1">)</span><span class="o">.</span><span class="n">body</span><span class="p" data-group-id="2032259416-2">[</span><span class="s">&quot;description&quot;</span><span class="p" data-group-id="2032259416-2">]</span><span class="w">
</span><span class="c1">#=&gt; &quot;Elixir is a dynamic, functional language designed for building scalable and maintainable applications&quot;</span></code></pre><p>Here is the equivalent using the low-level API:</p><pre><code class="makeup elixir" translate="no"><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://api.github.com/repos/elixir-lang/elixir&quot;</span><span class="w">

</span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="p" data-group-id="1086139709-1">%</span><span class="nc" data-group-id="1086139709-1">Req.Request</span><span class="p" data-group-id="1086139709-1">{</span><span class="ss">method</span><span class="p">:</span><span class="w"> </span><span class="ss">:get</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="n">url</span><span class="p" data-group-id="1086139709-1">}</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_request_steps</span><span class="p" data-group-id="1086139709-2">(</span><span class="w">
    </span><span class="ss">put_user_agent</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Req.Steps</span><span class="o">.</span><span class="n">put_user_agent</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="c1"># ...</span><span class="w">
  </span><span class="p" data-group-id="1086139709-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_response_steps</span><span class="p" data-group-id="1086139709-3">(</span><span class="w">
    </span><span class="c1"># ...</span><span class="w">
    </span><span class="ss">decompress_body</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Req.Steps</span><span class="o">.</span><span class="n">decompress_body</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="ss">decode_body</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Req.Steps</span><span class="o">.</span><span class="n">decode_body</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="c1"># ...</span><span class="w">
  </span><span class="p" data-group-id="1086139709-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_error_steps</span><span class="p" data-group-id="1086139709-4">(</span><span class="w">
    </span><span class="ss">retry</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Req.Steps</span><span class="o">.</span><span class="n">retry</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="c1"># ...</span><span class="w">
  </span><span class="p" data-group-id="1086139709-4">)</span><span class="w">

</span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">run!</span><span class="p" data-group-id="1086139709-5">(</span><span class="n">req</span><span class="p" data-group-id="1086139709-5">)</span><span class="o">.</span><span class="n">body</span><span class="p" data-group-id="1086139709-6">[</span><span class="s">&quot;description&quot;</span><span class="p" data-group-id="1086139709-6">]</span><span class="w">
</span><span class="c1">#=&gt; &quot;Elixir is a dynamic, functional language designed for building scalable and maintainable applications&quot;</span></code></pre><p>By putting the request pipeline yourself you have precise control of exactly what is running and in what order.</p><h2 id="module-the-request-struct" class="section-heading">
  <a href="#module-the-request-struct" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">the-request-struct</p>
  </a>
  The Request Struct
</h2>
<ul><li><p><code class="inline">:method</code> - the HTTP request method</p></li><li><p><code class="inline">:url</code> - the HTTP request URL</p></li><li><p><code class="inline">:headers</code> - the HTTP request headers</p></li><li><p><code class="inline">:body</code> - the HTTP request body</p></li><li><p><code class="inline">:options</code> - the options to be used by steps. See <a href="#module-options">&quot;Options&quot;</a> section below
for more information.</p></li><li><p><code class="inline">:halted</code> - whether the request pipeline is halted. See <a href="#halt/1"><code class="inline">halt/1</code></a></p></li><li><p><code class="inline">:adapter</code> - a request step that makes the actual HTTP request. Defaults to
<a href="Req.Steps.html#run_finch/1"><code class="inline">Req.Steps.run_finch/1</code></a>. See <a href="#module-adapter">&quot;Adapter&quot;</a> section below for more information.</p></li><li><p><code class="inline">:request_steps</code> - the list of request steps</p></li><li><p><code class="inline">:response_steps</code> - the list of response steps</p></li><li><p><code class="inline">:error_steps</code> - the list of error steps</p></li><li><p><code class="inline">:private</code> - a map reserved for libraries and frameworks to use.
Prefix the keys with the name of your project to avoid any future
conflicts. Only accepts <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types"><code class="inline">atom/0</code></a> keys.</p></li></ul><h2 id="module-steps" class="section-heading">
  <a href="#module-steps" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">steps</p>
  </a>
  Steps
</h2>
<p>Req has three types of steps: request, response, and error.</p><p>Request steps are used to refine the data that will be sent to the server.</p><p>After making the actual HTTP request, we'll either get a HTTP response or an error.
The request, along with the response or error, will go through response or
error steps, respectively.</p><p>Nothing is actually executed until we run the pipeline with <a href="#run/1"><code class="inline">Req.Request.run/1</code></a>.</p><h3 id="module-request-steps" class="section-heading">
  <a href="#module-request-steps" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">request-steps</p>
  </a>
  Request steps
</h3>
<p>A request step is a function that accepts a <code class="inline">request</code> and returns one of the following:</p><ul><li><p>A <code class="inline">request</code></p></li><li><p>A <code class="inline">{request, response_or_error}</code> tuple. In that case no further request steps are executed
and the return value goes through response or error steps</p></li></ul><p>Examples:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">put_default_headers</span><span class="p" data-group-id="9513355778-1">(</span><span class="n">request</span><span class="p" data-group-id="9513355778-1">)</span><span class="w"> </span><span class="k" data-group-id="9513355778-2">do</span><span class="w">
  </span><span class="n">update_in</span><span class="p" data-group-id="9513355778-3">(</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="p" data-group-id="9513355778-4">[</span><span class="p" data-group-id="9513355778-5">{</span><span class="s">&quot;user-agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;req&quot;</span><span class="p" data-group-id="9513355778-5">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ni">&amp;1</span><span class="p" data-group-id="9513355778-4">]</span><span class="p" data-group-id="9513355778-3">)</span><span class="w">
</span><span class="k" data-group-id="9513355778-2">end</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">read_from_cache</span><span class="p" data-group-id="9513355778-6">(</span><span class="n">request</span><span class="p" data-group-id="9513355778-6">)</span><span class="w"> </span><span class="k" data-group-id="9513355778-7">do</span><span class="w">
  </span><span class="k">case</span><span class="w"> </span><span class="nc">ResponseCache</span><span class="o">.</span><span class="n">fetch</span><span class="p" data-group-id="9513355778-8">(</span><span class="n">request</span><span class="p" data-group-id="9513355778-8">)</span><span class="w"> </span><span class="k" data-group-id="9513355778-9">do</span><span class="w">
    </span><span class="p" data-group-id="9513355778-10">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="9513355778-10">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="9513355778-11">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="9513355778-11">}</span><span class="w">
    </span><span class="ss">:error</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">request</span><span class="w">
  </span><span class="k" data-group-id="9513355778-9">end</span><span class="w">
</span><span class="k" data-group-id="9513355778-7">end</span></code></pre><h3 id="module-response-and-error-steps" class="section-heading">
  <a href="#module-response-and-error-steps" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">response-and-error-steps</p>
  </a>
  Response and error steps
</h3>
<p>A response step is a function that accepts a <code class="inline">{request, response}</code> tuple and returns one of the
following:</p><ul><li><p>A <code class="inline">{request, response}</code> tuple</p></li><li><p>A <code class="inline">{request, exception}</code> tuple. In that case, no further response steps are executed but the
exception goes through error steps</p></li></ul><p>Similarly, an error step is a function that accepts a <code class="inline">{request, exception}</code> tuple and returns one
of the following:</p><ul><li><p>A <code class="inline">{request, exception}</code> tuple</p></li><li><p>A <code class="inline">{request, response}</code> tuple. In that case, no further error steps are executed but the
response goes through response steps</p></li></ul><p>Examples:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">decode</span><span class="p" data-group-id="2542990088-1">(</span><span class="p" data-group-id="2542990088-2">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="2542990088-2">}</span><span class="p" data-group-id="2542990088-1">)</span><span class="w"> </span><span class="k" data-group-id="2542990088-3">do</span><span class="w">
  </span><span class="k">case</span><span class="w"> </span><span class="nc">List</span><span class="o">.</span><span class="n">keyfind</span><span class="p" data-group-id="2542990088-4">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;content-type&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="2542990088-4">)</span><span class="w"> </span><span class="k" data-group-id="2542990088-5">do</span><span class="w">
    </span><span class="p" data-group-id="2542990088-6">{</span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="2542990088-6">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="p" data-group-id="2542990088-7">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">update_in</span><span class="p" data-group-id="2542990088-8">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Jason</span><span class="o">.</span><span class="n">decode!</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="2542990088-8">)</span><span class="p" data-group-id="2542990088-7">}</span><span class="w">

    </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="p" data-group-id="2542990088-9">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="2542990088-9">}</span><span class="w">
  </span><span class="k" data-group-id="2542990088-5">end</span><span class="w">
</span><span class="k" data-group-id="2542990088-3">end</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">log_error</span><span class="p" data-group-id="2542990088-10">(</span><span class="p" data-group-id="2542990088-11">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="2542990088-11">}</span><span class="p" data-group-id="2542990088-10">)</span><span class="w"> </span><span class="k" data-group-id="2542990088-12">do</span><span class="w">
  </span><span class="nc">Logger</span><span class="o">.</span><span class="n">error</span><span class="p" data-group-id="2542990088-13">(</span><span class="p" data-group-id="2542990088-14">[</span><span class="s">&quot;</span><span class="si" data-group-id="2542990088-15">#{</span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="si" data-group-id="2542990088-15">}</span><span class="s"> </span><span class="si" data-group-id="2542990088-16">#{</span><span class="n">request</span><span class="o">.</span><span class="n">uri</span><span class="si" data-group-id="2542990088-16">}</span><span class="s">: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Exception</span><span class="o">.</span><span class="n">message</span><span class="p" data-group-id="2542990088-17">(</span><span class="n">exception</span><span class="p" data-group-id="2542990088-17">)</span><span class="p" data-group-id="2542990088-14">]</span><span class="p" data-group-id="2542990088-13">)</span><span class="w">
  </span><span class="p" data-group-id="2542990088-18">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="2542990088-18">}</span><span class="w">
</span><span class="k" data-group-id="2542990088-12">end</span></code></pre><h3 id="module-halting" class="section-heading">
  <a href="#module-halting" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">halting</p>
  </a>
  Halting
</h3>
<p>Any step can call <a href="#halt/1"><code class="inline">halt/1</code></a> to halt the pipeline. This will prevent any further steps
from being invoked.</p><p>Examples:</p><pre><code class="makeup elixir" translate="no"><span class="kd">def</span><span class="w"> </span><span class="nf">circuit_breaker</span><span class="p" data-group-id="0153709118-1">(</span><span class="n">request</span><span class="p" data-group-id="0153709118-1">)</span><span class="w"> </span><span class="k" data-group-id="0153709118-2">do</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="nc">CircuitBreaker</span><span class="o">.</span><span class="n">open?</span><span class="p" data-group-id="0153709118-3">(</span><span class="p" data-group-id="0153709118-3">)</span><span class="w"> </span><span class="k" data-group-id="0153709118-4">do</span><span class="w">
    </span><span class="p" data-group-id="0153709118-5">{</span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">halt</span><span class="p" data-group-id="0153709118-6">(</span><span class="n">request</span><span class="p" data-group-id="0153709118-6">)</span><span class="p">,</span><span class="w"> </span><span class="nc">RuntimeError</span><span class="o">.</span><span class="n">exception</span><span class="p" data-group-id="0153709118-7">(</span><span class="s">&quot;circuit breaker is open&quot;</span><span class="p" data-group-id="0153709118-7">)</span><span class="p" data-group-id="0153709118-5">}</span><span class="w">
  </span><span class="k" data-group-id="0153709118-4">else</span><span class="w">
    </span><span class="n">request</span><span class="w">
  </span><span class="k" data-group-id="0153709118-4">end</span><span class="w">
</span><span class="k" data-group-id="0153709118-2">end</span></code></pre><h2 id="module-writing-plugins" class="section-heading">
  <a href="#module-writing-plugins" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">writing-plugins</p>
  </a>
  Writing Plugins
</h2>
<p>Custom steps can be packaged into plugins so that they are even easier to use by others.</p><p>Here's an example plugin:</p><pre><code class="makeup elixir" translate="no"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">PrintHeaders</span><span class="w"> </span><span class="k" data-group-id="3945885124-1">do</span><span class="w">
  </span><span class="na">@doc</span><span class="w"> </span><span class="s">&quot;&quot;&quot;
  Prints request and response headers.

  ## Request Options

    * `:print_headers` - if `true`, prints the headers. Defaults to `false`.
  &quot;&quot;&quot;</span><span class="w">
  </span><span class="kd">def</span><span class="w"> </span><span class="nf">attach</span><span class="p" data-group-id="3945885124-2">(</span><span class="p" data-group-id="3945885124-3">%</span><span class="nc" data-group-id="3945885124-3">Req.Request</span><span class="p" data-group-id="3945885124-3">{</span><span class="p" data-group-id="3945885124-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="p" data-group-id="3945885124-4">[</span><span class="p" data-group-id="3945885124-4">]</span><span class="p" data-group-id="3945885124-2">)</span><span class="w"> </span><span class="k" data-group-id="3945885124-5">do</span><span class="w">
    </span><span class="n">request</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">register_options</span><span class="p" data-group-id="3945885124-6">(</span><span class="p" data-group-id="3945885124-7">[</span><span class="ss">:print_headers</span><span class="p" data-group-id="3945885124-7">]</span><span class="p" data-group-id="3945885124-6">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">merge_options</span><span class="p" data-group-id="3945885124-8">(</span><span class="n">options</span><span class="p" data-group-id="3945885124-8">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_request_steps</span><span class="p" data-group-id="3945885124-9">(</span><span class="ss">print_headers</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">print_request_headers</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="3945885124-9">)</span><span class="w">
    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">prepend_response_steps</span><span class="p" data-group-id="3945885124-10">(</span><span class="ss">print_headers</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">print_response_headers</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="3945885124-10">)</span><span class="w">
  </span><span class="k" data-group-id="3945885124-5">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">print_request_headers</span><span class="p" data-group-id="3945885124-11">(</span><span class="n">request</span><span class="p" data-group-id="3945885124-11">)</span><span class="w"> </span><span class="k" data-group-id="3945885124-12">do</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">options</span><span class="p" data-group-id="3945885124-13">[</span><span class="ss">:print_headers</span><span class="p" data-group-id="3945885124-13">]</span><span class="w"> </span><span class="k" data-group-id="3945885124-14">do</span><span class="w">
      </span><span class="n">print_headers</span><span class="p" data-group-id="3945885124-15">(</span><span class="s">&quot;&gt; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p" data-group-id="3945885124-15">)</span><span class="w">
    </span><span class="k" data-group-id="3945885124-14">end</span><span class="w">

    </span><span class="n">request</span><span class="w">
  </span><span class="k" data-group-id="3945885124-12">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">print_response_headers</span><span class="p" data-group-id="3945885124-16">(</span><span class="p" data-group-id="3945885124-17">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="3945885124-17">}</span><span class="p" data-group-id="3945885124-16">)</span><span class="w"> </span><span class="k" data-group-id="3945885124-18">do</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">request</span><span class="o">.</span><span class="n">options</span><span class="p" data-group-id="3945885124-19">[</span><span class="ss">:print_headers</span><span class="p" data-group-id="3945885124-19">]</span><span class="w"> </span><span class="k" data-group-id="3945885124-20">do</span><span class="w">
      </span><span class="n">print_headers</span><span class="p" data-group-id="3945885124-21">(</span><span class="s">&quot;&lt; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p" data-group-id="3945885124-21">)</span><span class="w">
    </span><span class="k" data-group-id="3945885124-20">end</span><span class="w">

    </span><span class="p" data-group-id="3945885124-22">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="3945885124-22">}</span><span class="w">
  </span><span class="k" data-group-id="3945885124-18">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">print_headers</span><span class="p" data-group-id="3945885124-23">(</span><span class="n">prefix</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="p" data-group-id="3945885124-23">)</span><span class="w"> </span><span class="k" data-group-id="3945885124-24">do</span><span class="w">
    </span><span class="k">for</span><span class="w"> </span><span class="p" data-group-id="3945885124-25">{</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="3945885124-25">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="k" data-group-id="3945885124-26">do</span><span class="w">
      </span><span class="nc">IO</span><span class="o">.</span><span class="n">puts</span><span class="p" data-group-id="3945885124-27">(</span><span class="p" data-group-id="3945885124-28">[</span><span class="n">prefix</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="3945885124-28">]</span><span class="p" data-group-id="3945885124-27">)</span><span class="w">
    </span><span class="k" data-group-id="3945885124-26">end</span><span class="w">
  </span><span class="k" data-group-id="3945885124-24">end</span><span class="w">
</span><span class="k" data-group-id="3945885124-1">end</span></code></pre><p>And here is how we can use it:</p><pre><code class="makeup elixir" translate="no"><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="0443661486-1">(</span><span class="p" data-group-id="0443661486-1">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">PrintHeaders</span><span class="o">.</span><span class="n">attach</span><span class="p" data-group-id="0443661486-2">(</span><span class="p" data-group-id="0443661486-2">)</span><span class="w">

</span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="0443661486-3">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org/json&quot;</span><span class="p" data-group-id="0443661486-3">)</span><span class="o">.</span><span class="n">status</span><span class="w">
</span><span class="mi">200</span><span class="w">

</span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="0443661486-4">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org/json&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">print_headers</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="0443661486-4">)</span><span class="o">.</span><span class="n">status</span><span class="w">
</span><span class="c1"># Outputs:</span><span class="w">
</span><span class="c1"># &gt; accept-encoding: br, gzip, deflate</span><span class="w">
</span><span class="c1"># &gt; user-agent: req/0.3.0-dev</span><span class="w">
</span><span class="c1"># &lt; date: Wed, 11 May 2022 11:10:47 GMT</span><span class="w">
</span><span class="c1"># &lt; content-type: application/json</span><span class="w">
</span><span class="c1"># ...</span><span class="w">
</span><span class="mi">200</span><span class="w">

</span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="0443661486-5">(</span><span class="p" data-group-id="0443661486-5">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">PrintHeaders</span><span class="o">.</span><span class="n">attach</span><span class="p" data-group-id="0443661486-6">(</span><span class="ss">print_headers</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="0443661486-6">)</span><span class="w">
</span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="0443661486-7">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org/json&quot;</span><span class="p" data-group-id="0443661486-7">)</span><span class="o">.</span><span class="n">status</span><span class="w">
</span><span class="c1"># Outputs:</span><span class="w">
</span><span class="c1"># &gt; accept-encoding: br, gzip, deflate</span><span class="w">
</span><span class="c1"># ...</span><span class="w">
</span><span class="mi">200</span></code></pre><p>As you can see a plugin is simply a module. While this is not enforced, the plugin should follow
these conventions:</p><ul><li><p>It should export an <code class="inline">attach/1</code> function that takes and returns the request struct</p></li><li><p>The attach functions mostly just adds steps and it is the steps that do the actual work</p></li><li><p>A user should be able to attach your plugin alongside other plugins. For this reason,
plugin functionality should usually only happen on a specific &quot;trigger&quot;: on a specific
option, on a specific URL scheme or host, etc. This is especially important for plugins
that perform authentication; you don't want to accidentally expose a token from service A
when a user makes request to service B.</p></li><li><p>If your plugin supports custom options, register them with <a href="#register_options/2"><code class="inline">register_options/2</code></a></p></li><li><p>Sometimes it is useful to pass options when attaching the plugin. For that, export an
<code class="inline">attach/2</code> function and call <a href="#merge_options/2"><code class="inline">merge_options/2</code></a>. Remember to first register
options before merging!</p></li></ul><h2 id="module-adapter" class="section-heading">
  <a href="#module-adapter" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">adapter</p>
  </a>
  Adapter
</h2>
<p>As noted in the <a href="#module-request-steps">&quot;Request steps&quot;</a> section, a request step besides returning the request,
might also return <code class="inline">{request, response}</code> or <code class="inline">{request, exception}</code>, thus invoking either response or error steps next.
This is exactly how Req makes the underlying HTTP call, by invoking a request step that follows this contract.</p><p>The default adapter is using Finch via the <a href="Req.Steps.html#run_finch/1"><code class="inline">Req.Steps.run_finch/1</code></a> step.</p><p>Here is a mock adapter that always returns a successful response:</p><pre><code class="makeup elixir" translate="no"><span class="n">adapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="7557046109-1">fn</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7557046109-2">%</span><span class="nc" data-group-id="7557046109-2">Req.Response</span><span class="p" data-group-id="7557046109-2">{</span><span class="ss">status</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;it works!&quot;</span><span class="p" data-group-id="7557046109-2">}</span><span class="w">
  </span><span class="p" data-group-id="7557046109-3">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="7557046109-3">}</span><span class="w">
</span><span class="k" data-group-id="7557046109-1">end</span><span class="w">

</span><span class="nc">Req</span><span class="o">.</span><span class="n">request!</span><span class="p" data-group-id="7557046109-4">(</span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">adapter</span><span class="p">:</span><span class="w"> </span><span class="n">adapter</span><span class="p" data-group-id="7557046109-4">)</span><span class="o">.</span><span class="n">body</span><span class="w">
</span><span class="c1">#=&gt; &quot;it works!&quot;</span></code></pre><p>And here is a naive Hackney-based implementation:</p><pre><code class="makeup elixir" translate="no"><span class="n">hackney</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k" data-group-id="4697501755-1">fn</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="k">case</span><span class="w"> </span><span class="nc">:hackney</span><span class="o">.</span><span class="n">request</span><span class="p" data-group-id="4697501755-2">(</span><span class="w">
         </span><span class="n">request</span><span class="o">.</span><span class="n">method</span><span class="p">,</span><span class="w">
         </span><span class="nc">URI</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="4697501755-3">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p" data-group-id="4697501755-3">)</span><span class="p">,</span><span class="w">
         </span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span><span class="w">
         </span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">,</span><span class="w">
         </span><span class="p" data-group-id="4697501755-4">[</span><span class="ss">:with_body</span><span class="p" data-group-id="4697501755-4">]</span><span class="w">
       </span><span class="p" data-group-id="4697501755-2">)</span><span class="w"> </span><span class="k" data-group-id="4697501755-5">do</span><span class="w">
    </span><span class="p" data-group-id="4697501755-6">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="4697501755-6">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p" data-group-id="4697501755-7">{</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="4697501755-7">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4697501755-8">{</span><span class="nc">String</span><span class="o">.</span><span class="n">downcase</span><span class="p" data-group-id="4697501755-9">(</span><span class="n">name</span><span class="p" data-group-id="4697501755-9">)</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="4697501755-8">}</span><span class="w">
      </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="4697501755-10">%</span><span class="nc" data-group-id="4697501755-10">Req.Response</span><span class="p" data-group-id="4697501755-10">{</span><span class="ss">status</span><span class="p">:</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="ss">headers</span><span class="p">:</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="4697501755-10">}</span><span class="w">
      </span><span class="p" data-group-id="4697501755-11">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="4697501755-11">}</span><span class="w">

    </span><span class="p" data-group-id="4697501755-12">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p" data-group-id="4697501755-12">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="p" data-group-id="4697501755-13">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="nc">RuntimeError</span><span class="o">.</span><span class="n">exception</span><span class="p" data-group-id="4697501755-14">(</span><span class="n">inspect</span><span class="p" data-group-id="4697501755-15">(</span><span class="n">reason</span><span class="p" data-group-id="4697501755-15">)</span><span class="p" data-group-id="4697501755-14">)</span><span class="p" data-group-id="4697501755-13">}</span><span class="w">
  </span><span class="k" data-group-id="4697501755-5">end</span><span class="w">
</span><span class="k" data-group-id="4697501755-1">end</span><span class="w">

</span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="4697501755-16">(</span><span class="s">&quot;https://api.github.com/repos/elixir-lang/elixir&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">adapter</span><span class="p">:</span><span class="w"> </span><span class="n">hackney</span><span class="p" data-group-id="4697501755-16">)</span><span class="o">.</span><span class="n">body</span><span class="p" data-group-id="4697501755-17">[</span><span class="s">&quot;description&quot;</span><span class="p" data-group-id="4697501755-17">]</span><span class="w">
</span><span class="s">&quot;Elixir is a dynamic, functional language designed for building scalable and maintainable applications&quot;</span></code></pre>
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
      Summary
    </h1>

  <div class="summary-types summary">
    <h2>
      <a href="#types">Types</a>
    </h2>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#t:t/0" translate="no">t()</a>

        </div>

      </div>

  </div>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#append_error_steps/2" translate="no">append_error_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Appends error steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#append_request_steps/2" translate="no">append_request_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Appends request steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#append_response_steps/2" translate="no">append_response_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Appends response steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#get_header/2" translate="no">get_header(request, key)</a>

        </div>

          <div class="summary-synopsis"><p>Returns the values of the header specified by <code class="inline">key</code>.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#get_private/3" translate="no">get_private(request, key, default \\ nil)</a>

        </div>

          <div class="summary-synopsis"><p>Gets the value for a specific private <code class="inline">key</code>.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#halt/1" translate="no">halt(request)</a>

        </div>

          <div class="summary-synopsis"><p>Halts the request pipeline preventing any further steps from executing.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#merge_options/2" translate="no">merge_options(request, options)</a>

        </div>

          <div class="summary-synopsis"><p>Merges given options into the request.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#prepend_error_steps/2" translate="no">prepend_error_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Prepends error steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#prepend_request_steps/2" translate="no">prepend_request_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Prepends request steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#prepend_response_steps/2" translate="no">prepend_response_steps(request, steps)</a>

        </div>

          <div class="summary-synopsis"><p>Prepends response steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#put_header/3" translate="no">put_header(request, key, value)</a>

        </div>

          <div class="summary-synopsis"><p>Adds a new request header (<code class="inline">key</code>) if not present, otherwise replaces the
previous value of that header with <code class="inline">value</code>.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#put_private/3" translate="no">put_private(request, key, value)</a>

        </div>

          <div class="summary-synopsis"><p>Assigns a private <code class="inline">key</code> to <code class="inline">value</code>.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#register_options/2" translate="no">register_options(request, options)</a>

        </div>

          <div class="summary-synopsis"><p>Registers options to be used by a custom steps.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#run!/1" translate="no">run!(request)</a>

        </div>

          <div class="summary-synopsis"><p>Runs a request pipeline and returns a response or raises an error.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#run/1" translate="no">run(request)</a>

        </div>

          <div class="summary-synopsis"><p>Runs a request pipeline.</p></div>

      </div>

  </div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Types
    </h1>
    <div class="types-list">
<section class="detail" id="t:t/0">

  <div class="detail-header">
    <a href="#t:t/0" class="detail-link" title="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature" translate="no">t()</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L295" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@type</span> t() :: %Req.Request{
  adapter: request_step(),
  body: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">iodata</a>(),
  error_steps: [{name :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), error_step()}],
  halted: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">boolean</a>(),
  headers: [{<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()}],
  method: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(),
  options: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(),
  private: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(),
  registered_options: <a href="https://hexdocs.pm/elixir/MapSet.html#t:t/0">MapSet.t</a>(),
  request_steps: [{name :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), request_step()}],
  response_steps: [{name :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), response_step()}],
  url: <a href="https://hexdocs.pm/elixir/URI.html#t:t/0">URI.t</a>()
}</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Functions
    </h1>
    <div class="functions-list">
<section class="detail" id="append_error_steps/2">

  <div class="detail-header">
    <a href="#append_error_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">append_error_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L414" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Appends error steps.</p><h2 id="append_error_steps/2-examples" class="section-heading">
  <a href="#append_error_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_error_steps</span><span class="p" data-group-id="3744095144-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="3744095144-2">fn</span><span class="w"> </span><span class="p" data-group-id="3744095144-3">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="3744095144-3">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3744095144-4">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="3744095144-4">}</span><span class="w"> </span><span class="k" data-group-id="3744095144-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="3744095144-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="append_request_steps/2">

  <div class="detail-header">
    <a href="#append_request_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">append_request_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L358" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Appends request steps.</p><h2 id="append_request_steps/2-examples" class="section-heading">
  <a href="#append_request_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_request_steps</span><span class="p" data-group-id="2619317323-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="2619317323-2">fn</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k" data-group-id="2619317323-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="2619317323-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="append_response_steps/2">

  <div class="detail-header">
    <a href="#append_response_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">append_response_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L386" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Appends response steps.</p><h2 id="append_response_steps/2-examples" class="section-heading">
  <a href="#append_response_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">append_request_steps</span><span class="p" data-group-id="0545153355-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="0545153355-2">fn</span><span class="w"> </span><span class="p" data-group-id="0545153355-3">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="0545153355-3">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="0545153355-4">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="0545153355-4">}</span><span class="w"> </span><span class="k" data-group-id="0545153355-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="0545153355-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="get_header/2">

  <div class="detail-header">
    <a href="#get_header/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_header(request, key)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L475" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> get_header(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()]</pre>

      </div>

<p>Returns the values of the header specified by <code class="inline">key</code>.</p><h2 id="get_header/2-examples" class="section-heading">
  <a href="#get_header/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="4884817252-1">(</span><span class="ss">headers</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4884817252-2">[</span><span class="p" data-group-id="4884817252-3">{</span><span class="s">&quot;accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p" data-group-id="4884817252-3">}</span><span class="p" data-group-id="4884817252-2">]</span><span class="p" data-group-id="4884817252-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">get_header</span><span class="p" data-group-id="4884817252-4">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;accept&quot;</span><span class="p" data-group-id="4884817252-4">)</span><span class="w">
</span><span class="p" data-group-id="4884817252-5">[</span><span class="s">&quot;application/json&quot;</span><span class="p" data-group-id="4884817252-5">]</span></code></pre>
  </section>
</section>
<section class="detail" id="get_private/3">

    <span id="get_private/2"></span>

  <div class="detail-header">
    <a href="#get_private/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">get_private(request, key, default \\ nil)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L330" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Gets the value for a specific private <code class="inline">key</code>.</p>
  </section>
</section>
<section class="detail" id="halt/1">

  <div class="detail-header">
    <a href="#halt/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">halt(request)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L344" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Halts the request pipeline preventing any further steps from executing.</p>
  </section>
</section>
<section class="detail" id="merge_options/2">

  <div class="detail-header">
    <a href="#merge_options/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">merge_options(request, options)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L459" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> merge_options(
  <a href="#t:t/0">t</a>(),
  <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">keyword</a>()
) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Merges given options into the request.</p><h2 id="merge_options/2-examples" class="section-heading">
  <a href="#merge_options/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="0716945290-1">(</span><span class="ss">auth</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0716945290-2">{</span><span class="s">&quot;alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;secret&quot;</span><span class="p" data-group-id="0716945290-2">}</span><span class="p">,</span><span class="w"> </span><span class="ss">http_errors</span><span class="p">:</span><span class="w"> </span><span class="ss">:raise</span><span class="p" data-group-id="0716945290-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">merge_options</span><span class="p" data-group-id="0716945290-3">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="ss">auth</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0716945290-4">{</span><span class="ss">:bearer</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;abcd&quot;</span><span class="p" data-group-id="0716945290-4">}</span><span class="p">,</span><span class="w"> </span><span class="ss">base_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com&quot;</span><span class="p" data-group-id="0716945290-3">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="o">.</span><span class="n">options</span><span class="w">
</span><span class="p" data-group-id="0716945290-5">%{</span><span class="ss">auth</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0716945290-6">{</span><span class="ss">:bearer</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;abcd&quot;</span><span class="p" data-group-id="0716945290-6">}</span><span class="p">,</span><span class="w"> </span><span class="ss">base_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">http_errors</span><span class="p">:</span><span class="w"> </span><span class="ss">:raise</span><span class="p" data-group-id="0716945290-5">}</span></code></pre>
  </section>
</section>
<section class="detail" id="prepend_error_steps/2">

  <div class="detail-header">
    <a href="#prepend_error_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">prepend_error_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L428" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Prepends error steps.</p><h2 id="prepend_error_steps/2-examples" class="section-heading">
  <a href="#prepend_error_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">prepend_error_steps</span><span class="p" data-group-id="8617658391-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="8617658391-2">fn</span><span class="w"> </span><span class="p" data-group-id="8617658391-3">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="8617658391-3">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="8617658391-4">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p" data-group-id="8617658391-4">}</span><span class="w"> </span><span class="k" data-group-id="8617658391-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="8617658391-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="prepend_request_steps/2">

  <div class="detail-header">
    <a href="#prepend_request_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">prepend_request_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L372" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Prepends request steps.</p><h2 id="prepend_request_steps/2-examples" class="section-heading">
  <a href="#prepend_request_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">prepend_request_steps</span><span class="p" data-group-id="1166475216-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="1166475216-2">fn</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k" data-group-id="1166475216-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="1166475216-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="prepend_response_steps/2">

  <div class="detail-header">
    <a href="#prepend_response_steps/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">prepend_response_steps(request, steps)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L400" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Prepends response steps.</p><h2 id="prepend_response_steps/2-examples" class="section-heading">
  <a href="#prepend_response_steps/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="nc">Req.Request</span><span class="o">.</span><span class="n">prepend_request_steps</span><span class="p" data-group-id="7229678562-1">(</span><span class="n">request</span><span class="p">,</span><span class="w">
  </span><span class="ss">noop</span><span class="p">:</span><span class="w"> </span><span class="k" data-group-id="7229678562-2">fn</span><span class="w"> </span><span class="p" data-group-id="7229678562-3">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="7229678562-3">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="7229678562-4">{</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="7229678562-4">}</span><span class="w"> </span><span class="k" data-group-id="7229678562-2">end</span><span class="p">,</span><span class="w">
  </span><span class="ss">inspect</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">IO</span><span class="o">.</span><span class="n">inspect</span><span class="o">/</span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="7229678562-1">)</span></code></pre>
  </section>
</section>
<section class="detail" id="put_header/3">

  <div class="detail-header">
    <a href="#put_header/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">put_header(request, key, value)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L498" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">@spec</span> put_header(<a href="#t:t/0">t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: <a href="#t:t/0">t</a>()</pre>

      </div>

<p>Adds a new request header (<code class="inline">key</code>) if not present, otherwise replaces the
previous value of that header with <code class="inline">value</code>.</p><p>Because header keys are case-insensitive in both HTTP/1.1 and HTTP/2,
it is recommended for header keys to be in lowercase, to avoid sending
duplicate keys in a request.</p><p>Additionally, requests with mixed-case headers served over HTTP/2 are not
considered valid by common clients, resulting in dropped requests.</p><h2 id="put_header/3-examples" class="section-heading">
  <a href="#put_header/3-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="1060144481-1">(</span><span class="p" data-group-id="1060144481-1">)</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">put_header</span><span class="p" data-group-id="1060144481-2">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p" data-group-id="1060144481-2">)</span><span class="o">.</span><span class="n">headers</span><span class="w">
</span><span class="p" data-group-id="1060144481-3">[</span><span class="p" data-group-id="1060144481-4">{</span><span class="s">&quot;accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p" data-group-id="1060144481-4">}</span><span class="p" data-group-id="1060144481-3">]</span></code></pre>
  </section>
</section>
<section class="detail" id="put_private/3">

  <div class="detail-header">
    <a href="#put_private/3" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">put_private(request, key, value)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L337" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Assigns a private <code class="inline">key</code> to <code class="inline">value</code>.</p>
  </section>
</section>
<section class="detail" id="register_options/2">

  <div class="detail-header">
    <a href="#register_options/2" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">register_options(request, options)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L536" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Registers options to be used by a custom steps.</p><p>Req ensures that all used options were previously registered which helps
finding accidentally mistyped option names. If you're adding custom steps
that are accepting options, call this function to register them.</p><h2 id="register_options/2-examples" class="section-heading">
  <a href="#register_options/2-examples" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">examples</p>
  </a>
  Examples
</h2>
<pre><code class="makeup elixir" translate="no"><span class="gp unselectable">iex&gt; </span><span class="nc">Req</span><span class="o">.</span><span class="n">request!</span><span class="p" data-group-id="5355968061-1">(</span><span class="ss">urll</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org&quot;</span><span class="p" data-group-id="5355968061-1">)</span><span class="w">
</span><span class="gt">** (ArgumentError) unknown option :urll. Did you mean :url?</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5355968061-2">(</span><span class="ss">bas_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org&quot;</span><span class="p" data-group-id="5355968061-2">)</span><span class="w">
</span><span class="gt">** (ArgumentError) unknown option :bas_url. Did you mean :base_url?</span><span class="w">

</span><span class="gp unselectable">iex&gt; </span><span class="n">req</span><span class="w"> </span><span class="o">=</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="nc">Req</span><span class="o">.</span><span class="n">new</span><span class="p" data-group-id="5355968061-3">(</span><span class="ss">base_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://httpbin.org&quot;</span><span class="p" data-group-id="5355968061-3">)</span><span class="w">
</span><span class="gp unselectable">...&gt; </span><span class="w">  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Req.Request</span><span class="o">.</span><span class="n">register_options</span><span class="p" data-group-id="5355968061-4">(</span><span class="p" data-group-id="5355968061-5">[</span><span class="ss">:foo</span><span class="p" data-group-id="5355968061-5">]</span><span class="p" data-group-id="5355968061-4">)</span><span class="w">
</span><span class="gp unselectable">...&gt;</span><span class="w">
</span><span class="gp unselectable">iex&gt; </span><span class="nc">Req</span><span class="o">.</span><span class="n">get!</span><span class="p" data-group-id="5355968061-6">(</span><span class="n">req</span><span class="p">,</span><span class="w"> </span><span class="ss">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/status/201&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">foo</span><span class="p">:</span><span class="w"> </span><span class="ss">:bar</span><span class="p" data-group-id="5355968061-6">)</span><span class="o">.</span><span class="n">status</span><span class="w">
</span><span class="mi">201</span></code></pre>
  </section>
</section>
<section class="detail" id="run!/1">

  <div class="detail-header">
    <a href="#run!/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">run!(request)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L584" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Runs a request pipeline and returns a response or raises an error.</p><p>See <a href="#run/1"><code class="inline">run/1</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="run/1">

  <div class="detail-header">
    <a href="#run/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">run(request)</h1>

      <a href="https://github.com/wojtekmach/req/blob/v0.3.0-dev/lib/req/request.ex#L545" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Runs a request pipeline.</p><p>Returns <code class="inline">{:ok, response}</code> or <code class="inline">{:error, exception}</code>.</p>
  </section>
</section>

    </div>
  </section>

      <footer class="footer">

          <p>
            On Hex.pm:

            <span class="line">
              <a href="https://hex.pm/packages/req/0.3.0-dev" class="line footer-hex-package">Package</a>
              <a href="https://preview.hex.pm/preview/req/0.3.0-dev" class="line">Preview</a>

                <a href="https://preview.hex.pm/preview/req/0.3.0-dev/show/lib/req/request.ex">(current file)</a>

            </span>

            <button class="line footer-button display-quick-switch">
              Search
            </button>
          </p>

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.28.4) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
